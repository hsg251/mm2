-- Các tham số có thể thay đổi
local player = game.Players.LocalPlayer
local farmSpeed = 30          -- Tốc độ di chuyển (cao quá có thể bị phát hiện)
local autoFarmEnabled = false -- Bật/tắt chế độ auto farm coin
local resetWhenFull = true    -- Tự động reset khi đầy coin
local coinLimit = 40          -- Số coin tối đa trước khi reset

-- Tạo GUI với nhãn Thanhdan Hub
local screenGui = Instance.new("ScreenGui")
screenGui.Parent = player.PlayerGui

local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 300, 0, 200)
frame.Position = UDim2.new(0, 10, 0, 10)
frame.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
frame.Parent = screenGui

local titleLabel = Instance.new("TextLabel")
titleLabel.Size = UDim2.new(1, 0, 0, 50)
titleLabel.Position = UDim2.new(0, 0, 0, 0)
titleLabel.BackgroundColor3 = Color3.fromRGB(0, 0, 0)
titleLabel.Text = "Thanhdan Hub"
titleLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
titleLabel.TextSize = 20
titleLabel.TextAlign = Enum.TextAlign.Center
titleLabel.Parent = frame

local toggleAutoFarmButton = Instance.new("TextButton")
toggleAutoFarmButton.Size = UDim2.new(1, 0, 0, 50)
toggleAutoFarmButton.Position = UDim2.new(0, 0, 0, 60)
toggleAutoFarmButton.BackgroundColor3 = Color3.fromRGB(0, 255, 0)
toggleAutoFarmButton.Text = "Bật Auto Farm Coin"
toggleAutoFarmButton.TextColor3 = Color3.fromRGB(255, 255, 255)
toggleAutoFarmButton.TextSize = 18
toggleAutoFarmButton.Parent = frame

local resetCoinButton = Instance.new("TextButton")
resetCoinButton.Size = UDim2.new(1, 0, 0, 50)
resetCoinButton.Position = UDim2.new(0, 0, 0, 120)
resetCoinButton.BackgroundColor3 = Color3.fromRGB(255, 0, 0)
resetCoinButton.Text = "Reset khi đầy Coin"
resetCoinButton.TextColor3 = Color3.fromRGB(255, 255, 255)
resetCoinButton.TextSize = 18
resetCoinButton.Parent = frame

-- Hàm tìm coin trong game
local function findCoin()
    local coins = {}
    for _, obj in pairs(workspace:GetDescendants()) do
        if obj.Name == "Coin" and obj:IsA("Part") then
            table.insert(coins, obj)
        end
    end
    return coins
end

-- Hàm di chuyển đến coin gần nhất
local function moveToCoin(coin)
    if not coin then return end
    local character = player.Character
    if character and character:FindFirstChild("HumanoidRootPart") then
        local humanoidRootPart = character.HumanoidRootPart
        humanoidRootPart.CFrame = coin.CFrame
    end
end

-- Hàm reset nhân vật
local function resetCharacter()
    if player.Character and player.Character:FindFirstChild("Humanoid") then
        player.Character.Humanoid.Health = 0 -- Đặt máu bằng 0 để reset
    end
end

-- Hàm kiểm tra số coin hiện tại
local function getCoinCount()
    local stats = player:FindFirstChild("leaderstats")
    if stats then
        local coins = stats:FindFirstChild("Coins")
        if coins then
            return tonumber(coins.Value) or 0
        end
    end
    return 0
end

-- Hàm kiểm tra và reset khi đầy coin
local function checkCoinLimit()
    local currentCoins = getCoinCount()
    if currentCoins >= coinLimit and resetWhenFull then
        print("Số coin đạt giới hạn! Đang reset...")
        resetCharacter()
        wait(2) -- Chờ 2 giây sau khi reset
    end
end

-- Hàm chính: Tự động farm coin
local function autoFarmLoop()
    while autoFarmEnabled do
        local coins = findCoin()
        if #coins > 0 then
            -- Tìm coin gần nhất
            local closestCoin = coins[1]
            for _, coin in pairs(coins) do
                if (coin.Position - player.Character.HumanoidRootPart.Position).Magnitude < (closestCoin.Position - player.Character.HumanoidRootPart.Position).Magnitude then
                    closestCoin = coin
                end
            end
            -- Di chuyển đến coin gần nhất
            moveToCoin(closestCoin)
        end
        checkCoinLimit() -- Kiểm tra và reset khi đầy coin
        wait(0.5) -- Giới hạn tốc độ vòng lặp để tránh quá tải
    end
end

-- Tạo sự kiện bật/tắt Auto Farm
toggleAutoFarmButton.MouseButton1Click:Connect(function()
    autoFarmEnabled = not autoFarmEnabled
    if autoFarmEnabled then
        toggleAutoFarmButton.Text = "Tắt Auto Farm Coin"
        print("Auto farm coin đã bật.")
        autoFarmLoop() -- Bắt đầu auto farm khi bật
    else
        toggleAutoFarmButton.Text = "Bật Auto Farm Coin"
        print("Auto farm coin đã tắt.")
    end
end)

-- Tạo sự kiện reset coin khi đầy
resetCoinButton.MouseButton1Click:Connect(function()
    resetWhenFull = not resetWhenFull
    if resetWhenFull then
        resetCoinButton.Text = "Tắt Reset khi đầy Coin"
        print("Chế độ reset khi đầy coin đã bật.")
    else
        resetCoinButton.Text = "Bật Reset khi đầy Coin"
        print("Chế độ reset khi đầy coin đã tắt.")
    end
end)

-- Tạo giao diện với nhãn và nút bấm
print("Thanhdan Hub đã khởi tạo thành công!")
